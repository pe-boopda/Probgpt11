# ü§ñ AI –ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

## üìã –û–±–∑–æ—Ä

AI —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–æ–±–∞–≤–ª—è–µ—Ç **—É–º–Ω—É—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É** —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GPT-4:

- ‚úÖ –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (–ø–æ–Ω–∏–º–∞–µ—Ç —Å–º—ã—Å–ª, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞)
- ‚úÖ –¢–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç—å –∫ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏ –∏ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞–º
- ‚úÖ –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–ª–∞–≥–∏–∞—Ç
- ‚úÖ –ú–∞—Å—Å–æ–≤–∞—è –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–∞
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AI

---

## üîë –ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–∞ OpenAI

### –®–∞–≥ 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://platform.openai.com/
2. –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –∏–ª–∏ –≤–æ–π–¥–∏—Ç–µ
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **API Keys**: https://platform.openai.com/api-keys
4. –ù–∞–∂–º–∏—Ç–µ **"Create new secret key"**
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!)

### –®–∞–≥ 2: –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Billing**: https://platform.openai.com/account/billing
2. –î–æ–±–∞–≤—å—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã
3. –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –Ω–∞—á–∞—Ç—å —Å $5-10)

### –°—Ç–æ–∏–º–æ—Å—Ç—å

**GPT-4o-mini** (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–µ):
- Input: $0.150 / 1M tokens (~$0.00015 –∑–∞ –∑–∞–ø—Ä–æ—Å)
- Output: $0.600 / 1M tokens (~$0.0006 –∑–∞ –æ—Ç–≤–µ—Ç)

**–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–¥–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞: ~$0.001 (0.1 —Ü–µ–Ω—Ç–∞)**

–î–ª—è 1000 —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å 5 —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏:
- 5000 –ø—Ä–æ–≤–µ—Ä–æ–∫ √ó $0.001 = **$5** –≤ –º–µ—Å—è—Ü

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Backend

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd backend
pip install openai
```

–î–æ–±–∞–≤—å—Ç–µ –≤ `requirements.txt`:
```txt
openai>=1.0.0
```

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í `backend/app/core/config.py`:

```python
from pydantic_settings import BaseSettings

class Settings(BaseSettings):
    # ... existing settings ...
    
    # OpenAI Configuration
    OPENAI_API_KEY: str = ""
    AI_GRADING_ENABLED: bool = True
    AI_GRADING_THRESHOLD: float = 0.7  # 70% confidence
    AI_GRADING_MODEL: str = "gpt-4o-mini"
    
    class Config:
        env_file = ".env"

settings = Settings()
```

### 3. Environment Variables

–í `backend/.env`:

```bash
# OpenAI Configuration
OPENAI_API_KEY=sk-proj-xxxxxxxxxxxxxxxxxxxxx
AI_GRADING_ENABLED=true
AI_GRADING_THRESHOLD=0.7
AI_GRADING_MODEL=gpt-4o-mini
```

‚ö†Ô∏è **–í–ê–ñ–ù–û**: –î–æ–±–∞–≤—å—Ç–µ `.env` –≤ `.gitignore`!

```bash
echo ".env" >> .gitignore
```

### 4. –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

```bash
# –°–æ–∑–¥–∞–π—Ç–µ AI service
backend/app/services/ai_grading_service.py

# –°–æ–∑–¥–∞–π—Ç–µ API endpoints
backend/app/api/ai_grading.py

# –û–±–Ω–æ–≤–∏—Ç–µ SessionService
backend/app/services/session_service.py
```

### 5. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–∞

–í `backend/app/main.py`:

```python
from app.api import ai_grading

# Register AI grading router
app.include_router(
    ai_grading.router,
    prefix="/api/ai-grading",
    tags=["ai-grading"]
)
```

### 6. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

–í `backend/app/models/test.py`, —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Question –∏–º–µ–µ—Ç metadata:

```python
class Question(Base):
    __tablename__ = "questions"
    
    # ... existing fields ...
    
    metadata = Column(JSON, nullable=True)
    # –§–æ—Ä–º–∞—Ç:
    # {
    #     "expected_answers": ["–æ—Ç–≤–µ—Ç 1", "–æ—Ç–≤–µ—Ç 2"],
    #     "keywords": ["–∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ 1", "—Å–ª–æ–≤–æ 2"],
    #     "grading_rubric": "–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏"
    # }
```

---

## üé® –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Frontend

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```bash
# –°–æ–∑–¥–∞–π—Ç–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
frontend/src/components/ai/AIFeedbackBadge.jsx
frontend/src/components/ai/RegradeButton.jsx
frontend/src/components/ai/ImprovementSuggestions.jsx
frontend/src/components/ai/PlagiarismCheck.jsx
```

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ TeacherResultsView

```jsx
import { AIFeedbackBadge, RegradeButton } from '@/components/ai';

// –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ—Ç–≤–µ—Ç–∞:
{answer.ai_feedback && (
  <AIFeedbackBadge feedback={answer.ai_feedback} />
)}

<RegradeButton 
  answerId={answer.id} 
  onSuccess={(result) => {
    console.log('Regraded:', result);
    // –û–±–Ω–æ–≤–∏—Ç—å UI
  }}
/>
```

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ AI —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

```jsx
import { AIStatsDashboard } from '@/components/ai';

// –í TeacherResultsView:
<AIStatsDashboard testId={testId} />
```

---

## üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è AI –ø—Ä–æ–≤–µ—Ä–∫–∏

### –§–æ—Ä–º–∞—Ç metadata –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤

```json
{
  "expected_answers": [
    "–§–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑ - —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å–≤–µ—Ç–∞ –≤ —Ö–∏–º–∏—á–µ—Å–∫—É—é —ç–Ω–µ—Ä–≥–∏—é",
    "–†–∞—Å—Ç–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–æ–ª–Ω–µ—á–Ω—ã–π —Å–≤–µ—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥–ª—é–∫–æ–∑—ã –∏–∑ CO2 –∏ –≤–æ–¥—ã"
  ],
  "keywords": [
    "—Å–æ–ª–Ω–µ—á–Ω—ã–π —Å–≤–µ—Ç",
    "—Ö–ª–æ—Ä–æ–ø–ª–∞—Å—Ç—ã",
    "—É–≥–ª–µ–∫–∏—Å–ª—ã–π –≥–∞–∑",
    "–≥–ª—é–∫–æ–∑–∞",
    "–∫–∏—Å–ª–æ—Ä–æ–¥"
  ],
  "grading_rubric": "–°—Ç—É–¥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω —É–ø–æ–º—è–Ω—É—Ç—å: 1) –∏—Å—Ç–æ—á–Ω–∏–∫ —ç–Ω–µ—Ä–≥–∏–∏ (—Å–≤–µ—Ç), 2) —Ä–µ–∞–≥–µ–Ω—Ç—ã (CO2, H2O), 3) –ø—Ä–æ–¥—É–∫—Ç—ã (–≥–ª—é–∫–æ–∑–∞, O2)"
}
```

### –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –≤–æ–ø—Ä–æ—Å–æ–≤

**–ò—Å—Ç–æ—Ä–∏—è:**
```json
{
  "expected_answers": [
    "–í—Ç–æ—Ä–∞—è –º–∏—Ä–æ–≤–∞—è –≤–æ–π–Ω–∞ –Ω–∞—á–∞–ª–∞—Å—å 1 —Å–µ–Ω—Ç—è–±—Ä—è 1939 –≥–æ–¥–∞ —Å –≤—Ç–æ—Ä–∂–µ–Ω–∏—è –ì–µ—Ä–º–∞–Ω–∏–∏ –≤ –ü–æ–ª—å—à—É"
  ],
  "keywords": ["1939", "–ì–µ—Ä–º–∞–Ω–∏—è", "–ü–æ–ª—å—à–∞", "–≤—Ç–æ—Ä–∂–µ–Ω–∏–µ", "—Å–µ–Ω—Ç—è–±—Ä—å"]
}
```

**–ë–∏–æ–ª–æ–≥–∏—è:**
```json
{
  "expected_answers": [
    "–î–ù–ö —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —Ü–µ–ø–µ–π –Ω—É–∫–ª–µ–æ—Ç–∏–¥–æ–≤, –∑–∞–∫—Ä—É—á–µ–Ω–Ω—ã—Ö –≤ –¥–≤–æ–π–Ω—É—é —Å–ø–∏—Ä–∞–ª—å"
  ],
  "keywords": ["–î–ù–ö", "–Ω—É–∫–ª–µ–æ—Ç–∏–¥—ã", "–¥–≤–æ–π–Ω–∞—è —Å–ø–∏—Ä–∞–ª—å", "–£–æ—Ç—Å–æ–Ω", "–ö—Ä–∏–∫"]
}
```

**–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞:**
```json
{
  "expected_answers": [
    "–¢–µ–æ—Ä–µ–º–∞ –ü–∏—Ñ–∞–≥–æ—Ä–∞: a¬≤ + b¬≤ = c¬≤, –≥–¥–µ c - –≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞"
  ],
  "keywords": ["—Ç–µ–æ—Ä–µ–º–∞", "–ü–∏—Ñ–∞–≥–æ—Ä–∞", "–≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞", "–∫–∞—Ç–µ—Ç—ã", "–∫–≤–∞–¥—Ä–∞—Ç"]
}
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è API

```python
# backend/test_ai.py
from app.services.ai_grading_service import AIGradingService

service = AIGradingService()

if service.enabled:
    print("‚úÖ OpenAI API –ø–æ–¥–∫–ª—é—á–µ–Ω —É—Å–ø–µ—à–Ω–æ")
    
    # –¢–µ—Å—Ç–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
    result = service.grade_text_answer(
        question=mock_question,
        student_answer="–¢–µ—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç",
        use_ai=True
    )
    
    print(f"Score: {result['score']}")
    print(f"Feedback: {result['feedback']}")
else:
    print("‚ùå OpenAI API –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
```

–ó–∞–ø—É—Å–∫:
```bash
cd backend
python test_ai.py
```

### 2. –¢–µ—Å—Ç–æ–≤—ã–µ –∫–µ–π—Å—ã

**–¢–µ—Å—Ç 1: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç**
```
–í–æ–ø—Ä–æ—Å: "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ñ–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑?"
–û—Ç–≤–µ—Ç: "–§–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑ - –ø—Ä–æ—Ü–µ—Å—Å, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —Ä–∞—Å—Ç–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç 
        —Å–≤–µ—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥–ª—é–∫–æ–∑—ã –∏–∑ CO2 –∏ –≤–æ–¥—ã"
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: Score > 0.85
```

**–¢–µ—Å—Ç 2: –ß–∞—Å—Ç–∏—á–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π**
```
–í–æ–ø—Ä–æ—Å: "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ñ–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑?"
–û—Ç–≤–µ—Ç: "–†–∞—Å—Ç–µ–Ω–∏—è –¥–µ–ª–∞—é—Ç –µ–¥—É –∏–∑ —Å–≤–µ—Ç–∞"
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: Score 0.4-0.6
```

**–¢–µ—Å—Ç 3: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π**
```
–í–æ–ø—Ä–æ—Å: "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ñ–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑?"
–û—Ç–≤–µ—Ç: "–≠—Ç–æ –∫–æ–≥–¥–∞ –∂–∏–≤–æ—Ç–Ω—ã–µ –µ–¥—è—Ç —Ä–∞—Å—Ç–µ–Ω–∏—è"
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: Score < 0.3
```

### 3. API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ü–µ—Ä–µ–æ—Ü–µ–Ω–∫–∞ –æ—Ç–≤–µ—Ç–∞
curl -X POST http://localhost:8000/api/ai-grading/answers/123/regrade \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"use_stricter_threshold": false}'

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
curl http://localhost:8000/api/ai-grading/answers/123/suggestions \
  -H "Authorization: Bearer YOUR_TOKEN"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–ª–∞–≥–∏–∞—Ç
curl -X POST http://localhost:8000/api/ai-grading/sessions/456/check-plagiarism \
  -H "Authorization: Bearer YOUR_TOKEN"
```

---

## ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### 1. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ API –≤—ã–∑–æ–≤–æ–≤, –∫—ç—à–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

```python
from functools import lru_cache
import hashlib

def get_cache_key(question_text: str, student_answer: str) -> str:
    """Generate cache key for answer"""
    combined = f"{question_text}:{student_answer}"
    return hashlib.md5(combined.encode()).hexdigest()

# –í AIGradingService:
@lru_cache(maxsize=1000)
def _grade_with_ai_cached(self, cache_key: str, ...):
    # ... grading logic
```

### 2. –ë–∞—Ç—á–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤

–î–ª—è –º–∞—Å—Å–æ–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–∞—Ç—á–∏:

```python
# –í–º–µ—Å—Ç–æ 100 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
for answer in answers:
    grade(answer)  # ‚ùå –ú–µ–¥–ª–µ–Ω–Ω–æ

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ batch
service.grade_text_answers_batch(answers)  # ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ
```

### 3. Fallback –Ω–∞ keywords

AI –Ω–µ –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–µ–Ω (–ø—Ä–æ–±–ª–µ–º—ã —Å API, –ª–∏–º–∏—Ç—ã). –í—Å–µ–≥–¥–∞ –∏–º–µ–π—Ç–µ fallback:

```python
try:
    result = ai_service.grade(...)
except Exception:
    result = keyword_matching_fallback(...)
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### 1. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ AI –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
# –í ai_grading_service.py
logger.info(f"AI grading: question_id={question.id}, score={result['score']}")
```

### 2. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏

```python
# –ü—Ä–∏–º–µ—Ä–Ω—ã–π –ø–æ–¥—Å—á—ë—Ç —Ç–æ–∫–µ–Ω–æ–≤
def estimate_cost(prompt: str, response: str) -> float:
    input_tokens = len(prompt.split()) * 1.3  # –ü—Ä–∏–º–µ—Ä–Ω–æ
    output_tokens = len(response.split()) * 1.3
    
    input_cost = (input_tokens / 1_000_000) * 0.150
    output_cost = (output_tokens / 1_000_000) * 0.600
    
    return input_cost + output_cost

total_cost = estimate_cost(prompt, response)
logger.info(f"AI call cost: ${total_cost:.4f}")
```

### 3. Dashboard –º–µ—Ç—Ä–∏–∫

```python
# –î–æ–±–∞–≤–∏—Ç—å endpoint –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
@router.get("/ai-grading/usage-stats")
async def get_usage_stats():
    return {
        "total_calls": 1500,
        "estimated_cost": "$1.50",
        "avg_score": 0.75,
        "manual_review_rate": 0.15
    }
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### 1. –ó–∞—â–∏—Ç–∞ API –∫–ª—é—á–∞

```python
# ‚ùå –ù–ï –î–ï–õ–ê–ô–¢–ï –¢–ê–ö
OPENAI_API_KEY = "sk-proj-xxxxx"  # –í –∫–æ–¥–µ

# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")  # –ò–∑ .env
```

### 2. Rate limiting

```python
from fastapi_limiter import FastAPILimiter
from fastapi_limiter.depends import RateLimiter

@router.post("/answers/{answer_id}/regrade")
@limiter.limit("10/minute")  # Max 10 regrading per minute
async def regrade_answer(...):
    ...
```

### 3. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```python
# –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–ª–∏–Ω—É –æ—Ç–≤–µ—Ç–æ–≤
MAX_ANSWER_LENGTH = 5000

if len(student_answer) > MAX_ANSWER_LENGTH:
    raise ValueError("Answer too long")
```

---

## üéØ Best Practices

### 1. –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–∂–∏–¥–∞–µ–º—ã–µ –æ—Ç–≤–µ—Ç—ã

```python
# ‚ùå –ü–ª–æ—Ö–æ
"expected_answers": ["–¥–∞"]

# ‚úÖ –•–æ—Ä–æ—à–æ
"expected_answers": [
    "–§–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑ - —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —Ä–∞—Å—Ç–µ–Ω–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç —Å–≤–µ—Ç–æ–≤—É—é —ç–Ω–µ—Ä–≥–∏—é –≤ —Ö–∏–º–∏—á–µ—Å–∫—É—é",
    "–≠—Ç–æ –±–∏–æ—Ö–∏–º–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å —Å–∏–Ω—Ç–µ–∑–∞ –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏—Ö –≤–µ—â–µ—Å—Ç–≤ –∏–∑ –Ω–µ–æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏—Ö –∑–∞ —Å—á—ë—Ç —ç–Ω–µ—Ä–≥–∏–∏ —Å–≤–µ—Ç–∞"
]
```

### 2. –†–∞–∑—É–º–Ω—ã–π threshold

```python
# –î–ª—è —Å—Ç—Ä–æ–≥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
threshold = 0.85  # 85% confidence

# –î–ª—è –º—è–≥–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
threshold = 0.65  # 65% confidence

# –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π
threshold = 0.70  # 70% confidence
```

### 3. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤

```python
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ AI –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
if len(student_answer.split()) > 20:
    use_ai = True
else:
    use_ai = False  # –ü—Ä–æ—Å—Ç—ã–µ –æ—Ç–≤–µ—Ç—ã - keyword matching
```

---

## üìà –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: –ü—Ä–æ—Å–º–æ—Ç—Ä AI –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏

```jsx
// –í TeacherResultsView.jsx
const AnswerReview = ({ answer }) => {
  return (
    <div>
      <p>–û—Ç–≤–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞: {answer.text}</p>
      
      {answer.ai_feedback && (
        <AIFeedbackBadge feedback={answer.ai_feedback} />
      )}
      
      <RegradeButton answerId={answer.id} />
    </div>
  );
};
```

### –°—Ç—É–¥–µ–Ω—Ç: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

```jsx
// –í StudentTestCompletionPage.jsx
const CompletionWithSuggestions = ({ sessionId }) => {
  return (
    <div>
      <h2>–¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à—ë–Ω!</h2>
      
      {/* –°—Ç—É–¥–µ–Ω—Ç –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ */}
      <ImprovementSuggestions answerId={answerId} />
    </div>
  );
};
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –∑–∞–ø—É—Å–∫–∞

- [ ] –ü–æ–ª—É—á–µ–Ω API –∫–ª—é—á OpenAI
- [ ] –ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω ($5-10 –¥–ª—è —Å—Ç–∞—Ä—Ç–∞)
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `openai` –ø–∞–∫–µ—Ç
- [ ] –°–æ–∑–¥–∞–Ω `.env` —Å OPENAI_API_KEY
- [ ] –°–æ–∑–¥–∞–Ω `ai_grading_service.py`
- [ ] –°–æ–∑–¥–∞–Ω `ai_grading.py` API
- [ ] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω —Ä–æ—É—Ç–µ—Ä –≤ main.py
- [ ] –û–±–Ω–æ–≤–ª—ë–Ω SessionService
- [ ] –°–æ–∑–¥–∞–Ω—ã Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∞ AI —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ UI
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
- [ ] –î–æ–±–∞–≤–ª–µ–Ω fallback –Ω–∞ keywords

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –≤–∞—à–∞ Testing System —É–º–µ–µ—Ç:

‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –æ—Ç–≤–µ—Ç—ã —Å –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º —Å–º—ã—Å–ª–∞
‚úÖ –î–∞–≤–∞—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å
‚úÖ –ü—Ä–µ–¥–ª–∞–≥–∞—Ç—å —É–ª—É—á—à–µ–Ω–∏—è
‚úÖ –û–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –ø–ª–∞–≥–∏–∞—Ç
‚úÖ –ú–∞—Å—Å–æ–≤–æ –ø–µ—Ä–µ–æ—Ü–µ–Ω–∏–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã
‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AI

**–°—Ç–æ–∏–º–æ—Å—Ç—å:** ~$0.001 –∑–∞ –ø—Ä–æ–≤–µ—Ä–∫—É (0.1 —Ü–µ–Ω—Ç–∞)
**–¢–æ—á–Ω–æ—Å—Ç—å:** 85-90% (—Å—Ä–∞–≤–Ω–∏–º–æ —Å —á–µ–ª–æ–≤–µ–∫–æ–º)
**–°–∫–æ—Ä–æ—Å—Ç—å:** –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ

–í–∞—à–∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç —ç–∫–æ–Ω–æ–º–∏—Ç—å **—á–∞—Å—ã –≤—Ä–µ–º–µ–Ω–∏** –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ! üöÄ