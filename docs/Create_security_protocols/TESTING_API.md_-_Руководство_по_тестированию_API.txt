# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API –¥–ª—è —Ç–µ—Å—Ç–æ–≤

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
# Backend
cd backend
source venv/bin/activate  # –∏–ª–∏ venv\Scripts\activate –Ω–∞ Windows
uvicorn app.main:app --reload

# –ò–ª–∏ —Å Docker
docker-compose up -d
```

### 2. –û—Ç–∫—Ä–æ–π—Ç–µ Swagger UI

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∞–¥—Ä–µ—Å—É: **http://localhost:8000/docs**

### 3. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å

1. –ù–∞–π–¥–∏—Ç–µ endpoint `POST /api/auth/login`
2. –ù–∞–∂–º–∏—Ç–µ "Try it out"
3. –í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∞–¥–º–∏–Ω–∞ (—Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–Ω–µ–µ):
```json
{
  "username": "admin",
  "password": "Admin123!"
}
```
4. –ù–∞–∂–º–∏—Ç–µ "Execute"
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `access_token` –∏–∑ –æ—Ç–≤–µ—Ç–∞
6. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Authorize" –≤–≤–µ—Ä—Ö—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
7. –í–≤–µ–¥–∏—Ç–µ: `Bearer –≤–∞—à_access_token`
8. –ù–∞–∂–º–∏—Ç–µ "Authorize" –∏ "Close"

–¢–µ–ø–µ—Ä—å –≤—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã –∏ –º–æ–∂–µ—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ endpoints!

---

## üìù –ü–æ—à–∞–≥–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞

**Endpoint**: `POST /api/tests`

**Request Body**:
```json
{
  "title": "–ú–æ–π –ø–µ—Ä–≤—ã–π —Ç–µ—Å—Ç",
  "description": "–¢–µ—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ",
  "time_limit": 30,
  "passing_score": 70,
  "show_results": true,
  "shuffle_questions": false,
  "shuffle_options": false
}
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 201 Created, —Ç–µ—Å—Ç —Å–æ–∑–¥–∞–Ω

**–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `id` –∏–∑ –æ—Ç–≤–µ—Ç–∞ - –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–∞–ª—å—à–µ!**

---

### –¢–µ—Å—Ç 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞ (Multiple Choice)

**Endpoint**: `POST /api/tests/{test_id}/questions`

–ó–∞–º–µ–Ω–∏—Ç–µ `{test_id}` –Ω–∞ ID –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞.

**Request Body**:
```json
{
  "question_type": "multiple_choice",
  "question_text": "–°–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç 2 + 2?",
  "order": 0,
  "points": 1.0,
  "image_id": null,
  "metadata": null,
  "options": [
    {
      "option_text": "3",
      "is_correct": false,
      "order": 0,
      "match_id": null
    },
    {
      "option_text": "4",
      "is_correct": true,
      "order": 1,
      "match_id": null
    },
    {
      "option_text": "5",
      "is_correct": false,
      "order": 2,
      "match_id": null
    }
  ]
}
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 201 Created, –≤–æ–ø—Ä–æ—Å –¥–æ–±–∞–≤–ª–µ–Ω

---

### –¢–µ—Å—Ç 3: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞ (True/False)

**Endpoint**: `POST /api/tests/{test_id}/questions`

**Request Body**:
```json
{
  "question_type": "true_false",
  "question_text": "–ó–µ–º–ª—è –∫—Ä—É–≥–ª–∞—è",
  "order": 1,
  "points": 1.0,
  "options": [
    {
      "option_text": "–ü—Ä–∞–≤–¥–∞",
      "is_correct": true,
      "order": 0
    },
    {
      "option_text": "–õ–æ–∂—å",
      "is_correct": false,
      "order": 1
    }
  ]
}
```

---

### –¢–µ—Å—Ç 4: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞ —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏

**Endpoint**: `GET /api/tests/{test_id}`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 200 OK, –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ—Å—Ç–µ —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ**:
- `questions_count` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 2
- –ú–∞—Å—Å–∏–≤ `questions` –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 2 –≤–æ–ø—Ä–æ—Å–∞
- –£ –∫–∞–∂–¥–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –µ—Å—Ç—å `options`

---

### –¢–µ—Å—Ç 5: –ü–æ–ø—ã—Ç–∫–∞ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Ç–µ—Å—Ç

**Endpoint**: `POST /api/tests/{test_id}/publish`

**Request Body**:
```json
{
  "is_published": true
}
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 200 OK, —Ç–µ—Å—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω (—Ç.–∫. –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã)

---

### –¢–µ—Å—Ç 6: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤

**Endpoint**: `GET /api/tests`

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `skip`: 0
- `limit`: 20
- `published_only`: true

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 200 OK, —Å–ø–∏—Å–æ–∫ —Å –æ–¥–Ω–∏–º –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–º —Ç–µ—Å—Ç–æ–º

---

### –¢–µ—Å—Ç 7: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞

**Endpoint**: `PUT /api/tests/questions/{question_id}`

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ID –ø–µ—Ä–≤–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞.

**Request Body**:
```json
{
  "question_text": "–°–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç 2 + 2? (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)",
  "points": 2.0
}
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 200 OK, –≤–æ–ø—Ä–æ—Å –æ–±–Ω–æ–≤–ª–µ–Ω

---

### –¢–µ—Å—Ç 8: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**Endpoint**: `GET /api/tests/{test_id}/statistics`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 200 OK, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–ø–æ–∫–∞ –≤—Å–µ –Ω—É–ª–∏, —Ç.–∫. –Ω–∏–∫—Ç–æ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª)

```json
{
  "test_id": 1,
  "total_attempts": 0,
  "completed_attempts": 0,
  "average_score": 0,
  "pass_rate": 0,
  "average_time_minutes": 0
}
```

---

### –¢–µ—Å—Ç 9: –ü–æ–∏—Å–∫ —Ç–µ—Å—Ç–æ–≤

**Endpoint**: `GET /api/tests`

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `search`: "–ø–µ—Ä–≤—ã–π"

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 200 OK, –Ω–∞–π–¥–µ–Ω —Ç–µ—Å—Ç —Å "–ø–µ—Ä–≤—ã–π" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏

---

### –¢–µ—Å—Ç 10: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç)

1. –ù–∞–∂–º–∏—Ç–µ "Authorize" –∏ "Logout"
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ `POST /api/tests`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 401 Unauthorized

---

## üéØ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

### –°–æ–∑–¥–∞–π—Ç–µ —Å—Ç—É–¥–µ–Ω—Ç–∞

**Endpoint**: `POST /api/auth/register`

**Request Body**:
```json
{
  "email": "student@test.com",
  "username": "student",
  "full_name": "Test Student",
  "password": "student123",
  "role": "student"
}
```

### –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ —Å—Ç—É–¥–µ–Ω—Ç

**Endpoint**: `POST /api/auth/login`

```json
{
  "username": "student",
  "password": "student123"
}
```

–ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å —Å –Ω–æ–≤—ã–º —Ç–æ–∫–µ–Ω–æ–º.

### –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç

**Endpoint**: `POST /api/tests`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 403 Forbidden - —Å—Ç—É–¥–µ–Ω—Ç—ã –Ω–µ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–µ—Å—Ç—ã

### –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç–æ–≤

**Endpoint**: `GET /api/tests`

**Query**: `published_only=true`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 200 OK - —Å—Ç—É–¥–µ–Ω—Ç –≤–∏–¥–∏—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

---

## üîç –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫

–ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:

- ‚úÖ –¢–µ—Å—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –í–æ–ø—Ä–æ—Å—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- ‚úÖ –ù–µ–ª—å–∑—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Ç–µ—Å—Ç –±–µ–∑ –≤–æ–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ú–æ–∂–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Ç–µ—Å—Ç —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏
- ‚úÖ –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –§–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ü–∞–≥–∏–Ω–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è
- ‚úÖ –ú–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç
- ‚úÖ –ú–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å
- ‚úÖ –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å
- ‚úÖ –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —Ç–µ—Å—Ç

---

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

### 422 Unprocessable Entity

**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤–µ—Ä–Ω—ã

### 403 Forbidden

**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤

**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–æ–ª—å—é

### 404 Not Found

**–ü—Ä–∏—á–∏–Ω–∞**: –¢–µ—Å—Ç –∏–ª–∏ –≤–æ–ø—Ä–æ—Å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å ID

### 400 Bad Request: "Cannot publish test without questions"

**–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ–ø—ã—Ç–∫–∞ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ø—É—Å—Ç–æ–π —Ç–µ—Å—Ç

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –≤–æ–ø—Ä–æ—Å –ø–µ—Ä–µ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
# Docker
docker-compose logs -f backend

# –õ–æ–∫–∞–ª—å–Ω–æ
# –°–º–æ—Ç—Ä–∏—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª –≥–¥–µ –∑–∞–ø—É—â–µ–Ω uvicorn
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î

```bash
# Docker
docker-compose exec db psql -U testuser -d testingdb

# –ö–æ–º–∞–Ω–¥—ã PostgreSQL
\dt  -- —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü
SELECT * FROM tests;
SELECT * FROM questions;
SELECT * FROM question_options;
```

---

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ:

```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∫–∞–∫ test_api.sh

#!/bin/bash

API="http://localhost:8000"

# 1. –õ–æ–≥–∏–Ω
TOKEN=$(curl -s -X POST "$API/api/auth/login" \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"Admin123!"}' \
  | jq -r '.access_token')

echo "‚úì –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞"

# 2. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞
TEST_ID=$(curl -s -X POST "$API/api/tests" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç",
    "description": "–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç–æ–º",
    "time_limit": 15,
    "passing_score": 60
  }' | jq -r '.id')

echo "‚úì –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω —Å ID: $TEST_ID"

# 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞
curl -s -X POST "$API/api/tests/$TEST_ID/questions" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "question_type": "multiple_choice",
    "question_text": "–¢–µ—Å—Ç–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å?",
    "points": 1.0,
    "options": [
      {"option_text": "–û—Ç–≤–µ—Ç 1", "is_correct": true, "order": 0},
      {"option_text": "–û—Ç–≤–µ—Ç 2", "is_correct": false, "order": 1}
    ]
  }' > /dev/null

echo "‚úì –í–æ–ø—Ä–æ—Å –¥–æ–±–∞–≤–ª–µ–Ω"

# 4. –ü—É–±–ª–∏–∫–∞—Ü–∏—è
curl -s -X POST "$API/api/tests/$TEST_ID/publish" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"is_published": true}' > /dev/null

echo "‚úì –¢–µ—Å—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω"

echo ""
echo "üéâ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!"
echo "–¢–µ—Å—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: $API/api/tests/$TEST_ID"
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
chmod +x test_api.sh
./test_api.sh
```

---

**–ì–æ—Ç–æ–≤–æ!** API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–∞–º–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ! üéâ